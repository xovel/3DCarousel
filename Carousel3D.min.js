/**!
 * Carousel3D
 * Just a 3D carousel plugin.
 * author: xovel
 * version: 0.0.3
 * repo: https://github.com/xovel/Carousel3D
 * license: MIT
 * Last update: Wed Aug 17 2016 09:29:39 GMT+0800
 */
+function(e,t,r){var a=function(e,t){for(var r in t){e[r]=t[r]}return e};var n=function(e,r){if(typeof e!=="string"){return e}return!r?t.querySelector(e):t.querySelectorAll(e)};var i=function(e,t,r){e.addEventListener(t,r,false)};var o=function(e,t){for(var r in t){e.style[r]=t[r]}};var u=function(e,t){var a,n=0,i=e.length;if(i===r){for(n in e){if(false===t.call(e[n],n,e[n]))break}}else{for(;n<i;n++){if(false===t.call(e[n],n,e[n]))break}}return e};var f=function(e,t){if("classList"in e){return e.classList.contains(t)}else{var r=e.className;if(!!r){r=" "+r+" ";if(r.indexOf(" "+t+" ")!==-1){return true}}}return false};var s=function(e,t){if("classList"in e){e.classList.add(t)}else{var r=e.className;if(!r){e.className=t}else{e.className+=" "+t}}};var c=function(e,t){if("classList"in e){e.classList.remove(t)}else{var r=e.className;if(!r){return}var a=r.split(/\s+/);var n=[];for(var i=0,o=a.length;i<o;i++){if(a[i]!==t){n.push(a[i])}}e.className=n.join(" ")}};var l=function(e){throw new Error(e)};var v=function(t){t=a({carousel:"",items:"",reflect:false,reflectValue:"below -5px -webkit-gradient(linear, left top,left bottom, from(rgba(0,0,0,0.25)), to(rgba(255,255,255,0.05)))",percent:.5,ratio:.3,depth:2,currentClass:"on","float":"left",opacity:.1,grayscale:1,sepia:1,blur:5,animate:300,fps:60,auto:8e3,click:true,keydown:false,wheel:false,resize:true,swipe:false,next:null,prev:null,callback:null},t||{});var r=n(t.carousel);var f=n(t.items,1);if(!f||!f.length){l("No items...")}var v=null;var p=null;var d={};d.len=f.length;d.step=360/d.len;d.speed=t.animate/t.fps;d.div=t.animate/d.speed;d.curr=0;d.from=0;d.to=0;var m=function(){clearTimeout(v);var e=r.offsetWidth;var a=e*t.ratio;o(r,{height:a+"px",position:"relative"});var n=f[0].offsetWidth;var i=f[0].offsetHeight;var s=n/i;var c=e*t.percent;d.width=e/2;d.height=a/2;d.degree=[];u(f,function(e,r){d.degree.push(360-Math.floor(e*d.step));o(r,{position:"absolute",width:c+"px",height:"auto",margin:"-"+c*s/2+"px auto auto -"+c/2+"px"});if(t.reflect){o(r,{"-webkit-box-reflect":t.reflectValue})}});h(0);C();M()};var h=function(e){var r=Math.PI;d.deg=[];u(d.degree,function(t,r){d.deg[t]=r+e+90});u(f,function(a,n){var i=d.deg[a]*r/180;var u=(d.degree[a]+e)%360*r/180;var f=u<r?u/r:(r*2-u)/r;var l=u>r?1-(r*2-u)/(r*t.depth):1-u/(r*t.depth);var v=d.width*(1+Math.cos(i));var p=d.height*(1+Math.sin(i));var m=(d.degree[a]+e+180)%360;var h=Math.ceil(m>180?(360-m)/d.step:m/d.step);o(n,{left:v+"px",top:p+"px","z-index":h,opacity:t.opacity<1?1-(1-t.opacity)*f:1,transform:"scale("+l+","+l+")","-webkit-filter":"grayscale("+(t.grayscale?t.grayscale*f:0)+") "+"sepia("+(t.sepia?t.sepia*f:0)+") "+"blur("+(t.blur?t.blur*f:0)+"px)"});if(h>=d.len/2){s(n,t.currentClass);d.index=a}else{c(n,t.currentClass)}})};var g=function(e){if(t.animate){d.super=e>d.curr;d.from=d.curr;d.curr=e;d.by=(d.curr-d.from)/d.div;w()}else{h(e);M()}};var w=function(){v=setTimeout(function(){d.super?d.from>=d.curr?(clearTimeout(v),M()):(y(),w()):d.from<=d.curr?(clearTimeout(v),M()):(y(),w())},d.speed)};var y=function(){d.from+=d.by;d.to=d.from<0?360- -d.from%360:d.from;h(d.to)};var b=function(){return d.index};var X=function(e){e=e||1;e=Math.floor(e);var t=d.curr+d.step*e;g(t);C()};var k=function(e){e=e||1;e=Math.floor(e);var t=d.curr-d.step*e;g(t);C()};var x=function(e){var t=d.step*e;g(t);C()};var N=function(){X()};var C=function(){clearInterval(p);if(t.auto){p=setInterval(N,t.auto)}};if(t.click){u(f,function(e,t){i(t,"click",function(){x(e)})})}if(t.wheel){i(r.parentNode,"wheel",function(e){var t=e.wheelDeltaY<0;!!t?k():X()})}if(t.keydown){i(e,"keydown",function(e){if(e.keyCode===37){k()}if(e.keyCode===39){X()}})}var L={};if(t.swipe){i(r.parentNode,"touchstart",function(e){L.startX=e.touches[0].clientX});i(r.parentNode,"touchmove",function(e){L.currentX=e.touches[0].clientX;if(L.startX&&L.startX>L.currentX){X();L={}}if(L.startX&&L.startX<L.currentX){k();L={}}});i(r.parentNode,"touchend",function(e){L={}})}if(t.drag||t.drop){i(r.parentNode,"mousedown",function(e){L.mouseStartX=e.clientX});i(r.parentNode,"mousemove",function(e){L.mouseCurrentX=e.clientX;if(L.mouseStartX&&L.mouseStartX>L.mouseCurrentX){X();L={}}if(L.mouseStartX&&L.mouseStartX<L.mouseCurrentX){k();L={}}if(e.preventDefault){e.preventDefault()}else{e.returnValue=false}});i(r.parentNode,"mouseup",function(e){L={}})}var M=function(){if(typeof t.callback==="function"){t.callback.call(f,b())}};if(t.prev){i(n(t.prev),"click",function(){k()})}if(t.next){i(n(t.next),"click",function(){X()})}m();if(t.resize){i(e,"resize",function(){m()})}return{cur:b,prev:k,next:X,to:x,reset:m,stop:function(){clearInterval(p);t.auto=0},auto:function(e){t.auto=e;C()}}};v.util={$:n,each:u,hasClass:f,addClass:s,removeClass:c,extend:a,on:i};e.Carousel3D=v;if(typeof define==="function"&&define.amd){define("Carousel3D",[],function(){return v})}}(window,document);